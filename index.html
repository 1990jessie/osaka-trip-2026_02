<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JOURNAL / OSAKA 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@600;900&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'jp-bg': '#F9F6F2',      // 柔和米白紙張色
                        'jp-ink': '#2D2D2D',     // 深炭灰
                        'jp-accent': '#7E909A',  // 灰藍調
                        'jp-sand': '#E8E2D9',    // 淺沙色
                        'jp-paper': '#FFFFFF'    // 純白
                    },
                    fontFamily: {
                        'sans': ['Noto Sans JP', 'sans-serif'],
                        'serif': ['Noto Serif JP', 'serif'],
                        'num': ['Montserrat', 'sans-serif']
                    },
                    borderRadius: {
                        'xl': '1rem',
                        '2xl': '1.5rem',
                        '3xl': '2rem'
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F9F6F2; color: #2D2D2D; font-family: 'Noto Sans JP', sans-serif; -webkit-font-smoothing: antialiased; }
        .serif-title { font-family: 'Noto Serif JP', serif; }
        .jp-border { border: 0.8px solid #E8E2D9; border-radius: 1.25rem; } /* 統一圓角邊框 */
        .soft-shadow { box-shadow: 0 10px 30px rgba(45, 45, 45, 0.05); }
        .active-tab { color: #7E909A !important; position: relative; }
        .active-tab::after { content: ''; position: absolute; bottom: -10px; width: 4px; height: 4px; background: #7E909A; border-radius: 50%; left: 50%; transform: translateX(-50%); }
        
        /* 雜誌感裝飾 */
        .date-badge { background: #2D2D2D; color: #F9F6F2; padding: 4px 12px; font-size: 10px; font-family: 'Montserrat'; font-weight: 700; border-radius: 50px; }
        
        .page-fade { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        input, textarea { background: transparent !important; }
        .btn-round { border-radius: 1rem; transition: all 0.2s; }
    </style>
</head>
<body class="pb-24">

    <header class="px-6 pt-12 pb-6 sticky top-0 bg-jp-bg/90 backdrop-blur-md z-40">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="serif-title text-3xl font-black tracking-tight">大阪旅行記.</h1>
                <p class="font-num text-[10px] tracking-[0.2em] opacity-40 uppercase mt-1 italic">Winter 2026</p>
            </div>
            <span class="date-badge">02.13 — 02.17</span>
        </div>
    </header>

    <main id="app" class="p-6 page-fade">
        </main>

    <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] bg-jp-ink/95 text-white/40 px-4 py-4 z-50 flex justify-around items-center rounded-3xl shadow-2xl backdrop-blur-lg">
        <button onclick="router('plan')" id="nav-plan" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-calendar-day text-lg"></i></button>
        <button onclick="router('food')" id="nav-food" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-utensils text-lg"></i></button>
        <button onclick="router('wallet')" id="nav-wallet" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-wallet text-lg"></i></button>
        <button onclick="router('buy')" id="nav-buy" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-bag-shopping text-lg"></i></button>
        <button onclick="router('lists')" id="nav-lists" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-check-double text-lg"></i></button>
        <button onclick="router('info')" id="nav-info" class="flex flex-col items-center gap-1 transition-all"><i class="fa-solid fa-info-circle text-lg"></i></button>
    </nav>

    <script>
        // --- DATA ---
        const ITINERARY = [
            { day: "01", date: "2/13 FRI", title: "暮色抵達", events: [
                { time: "19:20", title: "關西機場 (KIX) 著", type: "trans", map: "http://google.com/maps/search/KIX+Airport" },
                { time: "21:30", title: "南船場住宿", desc: "Wayfarer Matsu Check-in", map: "http://google.com/maps/search/Wayfarer+Matsu" }
            ]},
            { day: "02", date: "2/14 SAT", title: "下町散步", events: [
                { time: "10:00", title: "四天王寺參拜", type: "sight", map: "http://google.com/maps/search/Shitennoji" },
                { time: "15:15", title: "新世界散策", type: "sight", map: "http://google.com/maps/search/Shinsekai" },
                { time: "18:00", title: "難波夜食", type: "food", map: "http://google.com/maps/search/Namba" }
            ]},
            { day: "03", date: "2/15 SUN", title: "古都巡禮", events: [
                { time: "09:55", title: "百萬遍手作市集", type: "sight", desc: "知恩寺境內", map: "http://google.com/maps/search/Chion-ji" },
                { time: "13:30", title: "清水寺區域", type: "sight", map: "http://google.com/maps/search/Kiyomizu-dera" }
            ]},
            { day: "04", date: "2/16 MON", title: "湯浴時刻", events: [
                { time: "13:30", title: "空庭溫泉", type: "important", desc: "泡湯、浴衣休息", map: "http://google.com/maps/search/Solaniwa+Onsen" }
            ]},
            { day: "05", date: "2/17 TUE", title: "歸途購物", events: [
                { time: "11:00", title: "心齋橋最終採買", type: "sight", map: "http://google.com/maps/search/Shinsaibashi" },
                { time: "20:45", title: "關西機場起飛", type: "important" }
            ]}
        ];

        // --- CORE FUNCTIONS ---
        function router(target) {
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active-tab', 'text-white'));
            const active = document.getElementById(`nav-${target}`);
            active.classList.add('active-tab', 'text-white');
            window.scrollTo(0, 0);
            render(target);
        }

        function render(page) {
            const container = document.getElementById('app');
            if (page === 'plan') renderPlan(container);
            if (page === 'food') renderFood(container);
            if (page === 'wallet') renderWallet(container);
            if (page === 'buy') renderBuy(container);
            if (page === 'lists') renderLists(container);
            if (page === 'info') renderInfo(container);
        }

        // --- RENDER PLAN ---
        function renderPlan(el) {
            let html = `
                <div class="mb-10">
                    <div class="bg-jp-paper p-6 soft-shadow rounded-2xl flex justify-between items-center border border-jp-sand">
                        <div>
                            <p class="font-num text-[10px] font-bold opacity-30 tracking-[0.2em] mb-1">DEPARTURE</p>
                            <p class="font-num text-lg font-bold">D7378 <span class="text-xs opacity-40 ml-2">15:40</span></p>
                        </div>
                        <i class="fa-solid fa-plane text-jp-sand text-xl"></i>
                        <div class="text-right">
                            <p class="font-num text-[10px] font-bold opacity-30 tracking-[0.2em] mb-1">RETURN</p>
                            <p class="font-num text-lg font-bold">D7379 <span class="text-xs opacity-40 ml-2">20:45</span></p>
                        </div>
                    </div>
                </div>

                <div class="space-y-12">
                    ${ITINERARY.map(day => `
                        <div class="relative">
                            <div class="flex items-center gap-4 mb-6">
                                <div class="w-10 h-10 bg-jp-ink text-white rounded-full flex items-center justify-center font-num font-bold text-sm">${day.day}</div>
                                <div>
                                    <span class="font-num font-bold text-[10px] tracking-widest text-jp-accent block leading-none">${day.date}</span>
                                    <span class="serif-title text-xl font-bold">${day.title}</span>
                                </div>
                            </div>
                            
                            <div class="space-y-4">
                                ${day.events.map(ev => `
                                    <div class="bg-jp-paper p-5 rounded-2xl soft-shadow border border-jp-sand relative">
                                        <div class="flex justify-between items-start mb-2">
                                            <span class="font-num text-[10px] font-bold text-jp-accent bg-jp-bg px-2 py-1 rounded-lg">${ev.time}</span>
                                            ${ev.map ? `<button onclick="window.open('${ev.map}')" class="text-[9px] font-bold text-jp-accent"><i class="fa-solid fa-location-dot mr-1"></i>MAP</button>` : ''}
                                        </div>
                                        <p class="font-bold text-[15px] text-jp-ink">${ev.title}</p>
                                        ${ev.desc ? `<p class="text-[11px] opacity-40 mt-1 leading-relaxed italic">${ev.desc}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            el.innerHTML = html;
        }

        // --- RENDER FOOD ---
        function renderFood(el) {
            const list = ["Panya Bakery", "一蘭 心齋橋", "丸龜製麵", "Micasadeco Cafe", "利久牛舌", "東洋亭", "福太郎", "千房"];
            let html = `<h2 class="serif-title text-3xl mb-8">味覺記錄.</h2>`;
            html += `<div class="grid grid-cols-2 gap-4">`;
            list.forEach(f => {
                html += `
                    <div onclick="window.open('http://google.com/maps/search/${f}')" class="bg-jp-paper p-5 rounded-2xl soft-shadow border border-jp-sand active:scale-95 transition-transform">
                        <div class="w-8 h-8 bg-jp-bg rounded-full flex items-center justify-center mb-3">
                            <i class="fa-solid fa-utensils text-[10px] text-jp-accent"></i>
                        </div>
                        <p class="font-bold text-[13px] leading-tight">${f}</p>
                    </div>
                `;
            });
            html += `</div>`;
            el.innerHTML = html;
        }

        // --- RENDER WALLET ---
        let q = "";
        let currentExpImg = "";
        function renderWallet(el) {
            const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
            const total = expenses.reduce((s, i) => s + parseFloat(i.jpy), 0);

            el.innerHTML = `
                <div class="bg-jp-ink text-jp-bg p-8 mb-8 rounded-3xl shadow-xl">
                    <p class="font-num text-[10px] font-bold opacity-30 mb-4 tracking-widest uppercase">Quick Converter</p>
                    <div class="flex items-center gap-4 mb-4">
                        <input id="calc-input" readonly class="text-4xl font-num font-bold w-full outline-none text-white" placeholder="0">
                        <div class="text-right">
                            <p class="text-[10px] opacity-40 font-bold">TWD (÷5)</p>
                            <p id="calc-res-twd" class="text-xl font-num font-bold text-jp-accent">0</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-4 gap-2">
                        ${['7','8','9','/','4','5','6','*','1','2','3','-','0','C','⌫','+'].map(k => `
                            <button onclick="handleCalc('${k}')" class="p-4 font-num text-xs rounded-xl bg-white/5 hover:bg-white/10 active:bg-white/20 transition-all">${k}</button>
                        `).join('')}
                        <button onclick="calcResult()" class="col-span-4 p-4 mt-2 bg-jp-accent text-white font-bold rounded-xl active:scale-95 transition-all text-xs tracking-widest uppercase">Calculate</button>
                    </div>
                </div>

                <div class="bg-jp-paper p-6 rounded-2xl border border-jp-sand mb-8">
                    <div class="space-y-4">
                        <input id="ex-name" type="text" placeholder="品項項目" class="w-full border-b border-jp-sand py-3 text-sm outline-none px-2">
                        <input id="ex-jpy" type="number" placeholder="金額 (JPY)" class="w-full border-b border-jp-sand py-3 text-sm font-num outline-none px-2">
                        <div class="flex gap-3">
                            <label class="flex-1 bg-jp-bg p-4 flex flex-col items-center justify-center rounded-2xl cursor-pointer hover:bg-jp-sand/30 transition-all">
                                <i class="fa-solid fa-camera opacity-30 mb-1"></i>
                                <span class="text-[8px] font-bold opacity-30">RECIEPT</span>
                                <input type="file" class="hidden" accept="image/*" onchange="processImage(this)">
                            </label>
                            <button onclick="saveExpense()" class="flex-[3] bg-jp-ink text-white rounded-2xl font-bold text-xs tracking-widest active:scale-95 transition-all">SAVE ENTRY</button>
                        </div>
                        <div id="img-preview" class="hidden mt-2"><img id="preview-src" class="h-20 rounded-xl"></div>
                    </div>
                </div>

                <div class="space-y-3 pb-10">
                    <p class="serif-title text-lg flex justify-between items-end mb-4">
                        <span>開支流水.</span>
                        <span class="font-num text-[10px] opacity-30 uppercase font-bold tracking-widest">Total ¥${total}</span>
                    </p>
                    ${expenses.reverse().map((ex, i) => `
                        <div class="flex items-center gap-4 bg-jp-paper p-4 rounded-2xl border border-jp-sand">
                            <div class="w-12 h-12 bg-jp-bg rounded-xl overflow-hidden flex items-center justify-center flex-shrink-0">
                                ${ex.img ? `<img src="${ex.img}" class="w-full h-full object-cover">` : `<i class="fa-solid fa-receipt opacity-10"></i>`}
                            </div>
                            <div class="flex-1">
                                <p class="font-bold text-sm">${ex.name}</p>
                                <p class="font-num text-[10px] opacity-30 font-bold">¥${ex.jpy} / NT$${Math.round(ex.jpy/5)}</p>
                            </div>
                            <button onclick="deleteExpense(${i})" class="text-xs text-red-200 p-2"><i class="fa-solid fa-trash-can"></i></button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function handleCalc(k) {
            const input = document.getElementById('calc-input');
            if(k === 'C') q = "";
            else if(k === '⌫') q = q.slice(0, -1);
            else q += k;
            input.value = q;
        }
        function calcResult() {
            try {
                const res = eval(q);
                document.getElementById('calc-res-twd').innerText = Math.round(res/5);
                q = res.toString(); document.getElementById('calc-input').value = q;
            } catch { document.getElementById('calc-input').value = "ERR"; q = ""; }
        }
        function processImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const maxWidth = 300;
                        const scale = maxWidth / img.width;
                        canvas.width = maxWidth; canvas.height = img.height * scale;
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        currentExpImg = canvas.toDataURL('image/jpeg', 0.6);
                        document.getElementById('img-preview').classList.remove('hidden');
                        document.getElementById('preview-src').src = currentExpImg;
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
        function saveExpense() {
            const name = document.getElementById('ex-name').value;
            const jpy = document.getElementById('ex-jpy').value;
            if(!name || !jpy) return;
            const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
            expenses.push({ name, jpy, img: currentExpImg });
            localStorage.setItem('expenses', JSON.stringify(expenses));
            currentExpImg = ""; renderWallet(document.getElementById('app'));
        }
        function deleteExpense(i) {
            const expenses = JSON.parse(localStorage.getItem('expenses') || '[]');
            expenses.splice(expenses.length - 1 - i, 1);
            localStorage.setItem('expenses', JSON.stringify(expenses));
            renderWallet(document.getElementById('app'));
        }

        // --- OTHER PAGES ---
        function renderBuy(el) {
            const items = ["白色戀人", "薯條三兄弟", "合利他命 EX", "EVE 止痛藥", "DHC 護唇膏", "SK-II", "KitKat 抹茶"];
            el.innerHTML = `
                <h2 class="serif-title text-3xl mb-8">清單備忘.</h2>
                <div class="space-y-3">
                    ${items.map(item => `
                        <div onclick="window.open('https://www.google.com/search?q=${item}+日本')" class="bg-jp-paper p-5 rounded-2xl flex justify-between items-center border border-jp-sand active:scale-95 transition-all">
                            <span class="font-bold text-sm">${item}</span>
                            <i class="fa-solid fa-magnifying-glass text-[10px] opacity-10"></i>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderLists(el) {
            const list = ["護照", "機票", "Visit Japan QR", "現金", "信用卡", "行動電源", "好穿的鞋"];
            const checks = JSON.parse(localStorage.getItem('checks') || '{}');
            el.innerHTML = `
                <h2 class="serif-title text-3xl mb-8">準備清單.</h2>
                <div class="bg-jp-paper p-8 rounded-3xl border border-jp-sand space-y-6 mb-8">
                    ${list.map((item, i) => `
                        <label class="flex items-center gap-4 cursor-pointer group">
                            <input type="checkbox" class="peer hidden" onchange="toggleCheck(${i})" ${checks[i] ? 'checked' : ''}>
                            <div class="w-6 h-6 rounded-full border-2 border-jp-sand flex items-center justify-center peer-checked:bg-jp-accent peer-checked:border-jp-accent transition-all">
                                <i class="fa-solid fa-check text-white text-[10px] opacity-0 peer-checked:opacity-100"></i>
                            </div>
                            <span class="text-sm font-bold ${checks[i] ? 'line-through opacity-20' : ''}">${item}</span>
                        </label>
                    `).join('')}
                </div>
                <textarea id="memo-field" oninput="saveMemo()" class="w-full h-40 p-6 bg-jp-paper rounded-3xl border border-jp-sand text-sm outline-none shadow-inner" placeholder="隨手筆記...">${localStorage.getItem('memo') || ""}</textarea>
            `;
        }
        function toggleCheck(i) {
            const checks = JSON.parse(localStorage.getItem('checks') || '{}');
            checks[i] = !checks[i];
            localStorage.setItem('checks', JSON.stringify(checks));
            renderLists(document.getElementById('app'));
        }
        function saveMemo() { localStorage.setItem('memo', document.getElementById('memo-field').value); }

        function renderInfo(el) {
            el.innerHTML = `
                <h2 class="serif-title text-3xl mb-8">重要資訊.</h2>
                <div class="space-y-6">
                    <div class="bg-jp-accent text-white p-8 rounded-3xl shadow-lg">
                        <p class="font-bold text-xs tracking-widest mb-4 opacity-60">EMERGENCY CALL</p>
                        <div class="space-y-4">
                            <div class="flex justify-between border-b border-white/10 pb-2"><span class="font-bold">Police</span><span class="font-num">110</span></div>
                            <div class="flex justify-between border-b border-white/10 pb-2"><span class="font-bold">Ambulance</span><span class="font-num">119</span></div>
                        </div>
                    </div>
                    <div class="bg-jp-paper p-8 rounded-3xl border border-jp-sand text-[13px] leading-relaxed space-y-4">
                        <p class="font-bold opacity-30 tracking-widest uppercase text-[10px]">Travel Notice</p>
                        <p>● 大阪手扶梯習慣靠右站立。</p>
                        <p>● 2月大阪氣溫極低，需注意防風與室內暖氣價差。</p>
                        <p>● 建議隨身準備小額現金供小店支付。</p>
                    </div>
                </div>
            `;
        }

        window.onload = () => router('plan');
    </script>
</body>
</html>
